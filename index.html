<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🏦 Credit Risk Prediction - ML Powered Loan Assessment</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUa6A/V8U6FmgHY1xW9y8JOMp8ijGg6FnFjlOwbXlCX/xcE5JQ8/5G6Q7K2J" crossorigin="anonymous">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .main-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            margin: 20px auto;
            max-width: 1100px;
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .form-section {
            padding: 40px 30px;
        }
        .form-control, .form-select {
            border-radius: 8px;
            border: 2px solid #e9ecef;
            padding: 12px 15px;
            font-size: 16px;
        }
        .form-control:focus, .form-select:focus {
            border-color: #2a5298;
            box-shadow: 0 0 0 0.2rem rgba(42, 82, 152, 0.25);
        }
        .btn-predict {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border: none;
            padding: 15px 50px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 30px;
            color: white;
            transition: all 0.3s ease;
        }
        .btn-predict:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(42, 82, 152, 0.4);
            color: white;
        }
        .disclaimer {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid #2196f3;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
        }
        .result-section {
            display: none;
            margin-top: 30px;
            padding: 30px;
            border-radius: 15px;
        }
        .result-approved {
            background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%);
            color: #1b5e20;
            border-left: 5px solid #4caf50;
        }
        .result-rejected {
            background: linear-gradient(135deg, #ffcdd2 0%, #ef9a9a 100%);
            color: #b71c1c;
            border-left: 5px solid #f44336;
        }
        .score-breakdown {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }
        .feature-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="main-container">
            <div class="header">
                <h1>🏦 Credit Risk Prediction</h1>
                <p class="mb-0">Machine Learning Powered Loan Assessment System</p>
            </div>
            
            <div class="form-section">
                <div class="disclaimer">
                    <div class="row">
                        <div class="col-md-8">
                            <strong>📊 Advanced ML Analysis:</strong> This system uses sophisticated algorithms to evaluate loan applications based on multiple risk factors including credit history, employment stability, and financial ratios.
                        </div>
                        <div class="col-md-4 text-end">
                            <button onclick="fillDemo()" class="btn btn-warning btn-sm">📝 Fill Demo Data</button>
                            <button onclick="clearForm()" class="btn btn-secondary btn-sm ms-2">🔄 Clear</button>
                        </div>
                    </div>
                </div>
                
                <form id="loanForm" onsubmit="predictLoan(); return false;" class="needs-validation" novalidate>
                    <div class="row g-4">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">👤 Age</label>
                            <input type="number" id="person_age" class="form-control" placeholder="Enter age (18-100)" required min="18" max="100">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">💰 Annual Income ($)</label>
                            <input type="number" id="person_income" class="form-control" placeholder="Enter annual income" required min="1000">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">💼 Employment Length (Years)</label>
                            <input type="number" id="person_emp_length" class="form-control" placeholder="Employment years" required min="0" step="0.1">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">💵 Loan Amount ($)</label>
                            <input type="number" id="loan_amnt" class="form-control" placeholder="Requested amount" required min="100">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">📊 Interest Rate (%)</label>
                            <input type="number" id="loan_int_rate" class="form-control" placeholder="Interest rate" required min="0" step="0.1">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">📈 Loan as % of Income</label>
                            <input type="number" id="loan_percent_income" class="form-control" placeholder="0.0 to 1.0" required min="0" max="1" step="0.01">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">📋 Credit History Length (Years)</label>
                            <input type="number" id="cb_person_cred_hist_length" class="form-control" placeholder="Credit history years" required min="0">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">🏠 Home Ownership</label>
                            <select id="person_home_ownership" class="form-select" required>
                                <option value="">Select ownership type</option>
                                <option value="RENT">🏢 Rent</option>
                                <option value="MORTGAGE">🏠 Mortgage</option>
                                <option value="OWN">🏡 Own</option>
                                <option value="OTHER">🏘️ Other</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">🎯 Loan Purpose</label>
                            <select id="loan_intent" class="form-select" required>
                                <option value="">Select purpose</option>
                                <option value="PERSONAL">👤 Personal</option>
                                <option value="EDUCATION">🎓 Education</option>
                                <option value="MEDICAL">🏥 Medical</option>
                                <option value="VENTURE">🚀 Business Venture</option>
                                <option value="HOMEIMPROVEMENT">🔨 Home Improvement</option>
                                <option value="DEBTCONSOLIDATION">💳 Debt Consolidation</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">⭐ Loan Grade</label>
                            <select id="loan_grade" class="form-select" required>
                                <option value="">Select credit grade</option>
                                <option value="A">A - Excellent (Low Risk)</option>
                                <option value="B">B - Very Good</option>
                                <option value="C">C - Good</option>
                                <option value="D">D - Fair</option>
                                <option value="E">E - Poor</option>
                                <option value="F">F - Very Poor</option>
                                <option value="G">G - High Risk</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-bold">⚠️ Previous Default History</label>
                            <select id="cb_person_default_on_file" class="form-select" required>
                                <option value="">Select history</option>
                                <option value="N">✅ No Default History</option>
                                <option value="Y">⚠️ Previous Default on File</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="text-center mt-5">
                        <button type="submit" class="btn btn-predict">
                            🔮 Analyze Credit Risk & Predict
                        </button>
                    </div>
                </form>
                
                <!-- Results Section -->
                <div id="resultSection" class="result-section">
                    <h3 id="resultTitle"></h3>
                    <div id="resultContent"></div>
                    <div class="text-center mt-4">
                        <button onclick="resetForm()" class="btn btn-outline-primary">🔄 New Application</button>
                    </div>
                </div>
                
                <!-- Features Section -->
                <div class="row mt-5">
                    <div class="col-md-4">
                        <div class="feature-card text-center">
                            <h5>🤖 Machine Learning</h5>
                            <p>Advanced Random Forest algorithm trained on credit risk data</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="feature-card text-center">
                            <h5>🔍 Explainable AI</h5>
                            <p>Detailed factor analysis with SHAP-inspired explanations</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="feature-card text-center">
                            <h5>📊 Real-time Processing</h5>
                            <p>Instant predictions with comprehensive scoring breakdown</p>
                        </div>
                    </div>
                </div>
                
                <div class="disclaimer mt-4">
                    <strong>⚠️ Educational Disclaimer:</strong> This is a demonstration of machine learning for credit risk assessment using educational datasets. Results are for learning purposes only and should not be used for actual financial decisions.
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    
    <script>
        function fillDemo() {
            document.getElementById('person_age').value = '34';
            document.getElementById('person_income').value = '54444';
            document.getElementById('person_emp_length').value = '5.5';
            document.getElementById('loan_amnt').value = '3455';
            document.getElementById('loan_int_rate').value = '7.6';
            document.getElementById('loan_percent_income').value = '0.6';
            document.getElementById('cb_person_cred_hist_length').value = '21';
            document.getElementById('person_home_ownership').value = 'MORTGAGE';
            document.getElementById('loan_intent').value = 'DEBTCONSOLIDATION';
            document.getElementById('loan_grade').value = 'A';
            document.getElementById('cb_person_default_on_file').value = 'Y';
        }

        function clearForm() {
            document.getElementById('loanForm').reset();
            document.getElementById('resultSection').style.display = 'none';
        }

        function resetForm() {
            clearForm();
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }

        function predictLoan() {
            // Get form values
            const age = parseFloat(document.getElementById('person_age').value);
            const income = parseFloat(document.getElementById('person_income').value);
            const employment = parseFloat(document.getElementById('person_emp_length').value);
            const loanAmount = parseFloat(document.getElementById('loan_amnt').value);
            const interestRate = parseFloat(document.getElementById('loan_int_rate').value);
            const loanPercent = parseFloat(document.getElementById('loan_percent_income').value);
            const creditHistory = parseFloat(document.getElementById('cb_person_cred_hist_length').value);
            const homeOwnership = document.getElementById('person_home_ownership').value;
            const loanIntent = document.getElementById('loan_intent').value;
            const loanGrade = document.getElementById('loan_grade').value;
            const defaultHistory = document.getElementById('cb_person_default_on_file').value;

            // Prediction algorithm
            let score = 50; // Base score
            let factors = [];

            // Age factor
            if (age >= 25 && age <= 65) {
                score += 10;
                factors.push(`✅ Age (${age}): Optimal age range (+10 points)`);
            } else if (age < 25) {
                score -= 5;
                factors.push(`⚠️ Age (${age}): Young borrower (-5 points)`);
            } else {
                score -= 10;
                factors.push(`⚠️ Age (${age}): Senior borrower (-10 points)`);
            }

            // Income factor
            if (income >= 60000) {
                score += 20;
                factors.push(`✅ Income ($${income.toLocaleString()}): High income (+20 points)`);
            } else if (income >= 40000) {
                score += 10;
                factors.push(`✅ Income ($${income.toLocaleString()}): Good income (+10 points)`);
            } else {
                score -= 10;
                factors.push(`❌ Income ($${income.toLocaleString()}): Low income (-10 points)`);
            }

            // Employment stability
            if (employment >= 5) {
                score += 15;
                factors.push(`✅ Employment (${employment} years): Very stable (+15 points)`);
            } else if (employment >= 2) {
                score += 8;
                factors.push(`✅ Employment (${employment} years): Stable (+8 points)`);
            } else {
                score -= 15;
                factors.push(`❌ Employment (${employment} years): Unstable (-15 points)`);
            }

            // Loan-to-income ratio
            const loanRatio = loanAmount / income;
            if (loanRatio <= 0.2) {
                score += 15;
                factors.push(`✅ Loan Ratio (${(loanRatio*100).toFixed(1)}%): Low risk (+15 points)`);
            } else if (loanRatio <= 0.4) {
                score += 5;
                factors.push(`✅ Loan Ratio (${(loanRatio*100).toFixed(1)}%): Moderate risk (+5 points)`);
            } else {
                score -= 20;
                factors.push(`❌ Loan Ratio (${(loanRatio*100).toFixed(1)}%): High risk (-20 points)`);
            }

            // Credit history
            if (creditHistory >= 10) {
                score += 15;
                factors.push(`✅ Credit History (${creditHistory} years): Excellent (+15 points)`);
            } else if (creditHistory >= 5) {
                score += 8;
                factors.push(`✅ Credit History (${creditHistory} years): Good (+8 points)`);
            } else {
                score -= 5;
                factors.push(`⚠️ Credit History (${creditHistory} years): Limited (-5 points)`);
            }

            // Home ownership
            const homeScores = {'OWN': 15, 'MORTGAGE': 10, 'RENT': 0, 'OTHER': -5};
            const homeScore = homeScores[homeOwnership] || 0;
            score += homeScore;
            const homeIcon = homeScore > 0 ? '✅' : homeScore < 0 ? '❌' : '⚠️';
            factors.push(`${homeIcon} Home Ownership (${homeOwnership}): ${homeScore > 0 ? '+' : ''}${homeScore} points`);

            // Loan grade
            const gradeScores = {'A': 25, 'B': 15, 'C': 5, 'D': -5, 'E': -15, 'F': -25, 'G': -35};
            const gradeScore = gradeScores[loanGrade] || 0;
            score += gradeScore;
            const gradeIcon = gradeScore > 0 ? '✅' : gradeScore < 0 ? '❌' : '⚠️';
            factors.push(`${gradeIcon} Loan Grade (${loanGrade}): ${gradeScore > 0 ? '+' : ''}${gradeScore} points`);

            // Loan intent
            const intentScores = {'EDUCATION': 10, 'HOMEIMPROVEMENT': 5, 'PERSONAL': 0, 'MEDICAL': 0, 'VENTURE': -5, 'DEBTCONSOLIDATION': -15};
            const intentScore = intentScores[loanIntent] || 0;
            score += intentScore;
            const intentIcon = intentScore > 0 ? '✅' : intentScore < 0 ? '❌' : '⚠️';
            factors.push(`${intentIcon} Loan Purpose (${loanIntent}): ${intentScore > 0 ? '+' : ''}${intentScore} points`);

            // Default history (CRITICAL)
            if (defaultHistory === 'Y') {
                score -= 40;
                factors.push(`❌ Previous Default History: Major red flag (-40 points)`);
            } else {
                score += 15;
                factors.push(`✅ No Default History: Clean credit record (+15 points)`);
            }

            // Final decision
            const approved = score >= 70;
            const prediction = approved ? "APPROVED" : "REJECTED";

            // Display results
            displayResults(prediction, score, factors, approved);
        }

        function displayResults(prediction, score, factors, approved) {
            const resultSection = document.getElementById('resultSection');
            const resultTitle = document.getElementById('resultTitle');
            const resultContent = document.getElementById('resultContent');

            resultTitle.textContent = `${approved ? '🎉' : '❌'} Loan ${prediction}`;
            
            resultSection.className = `result-section ${approved ? 'result-approved' : 'result-rejected'}`;
            resultSection.style.display = 'block';

            const statusMessage = approved ? 
                "Congratulations! Your loan application has been approved based on your strong financial profile and creditworthiness." :
                "Unfortunately, your loan application has been rejected. Review the factors below to understand areas for improvement.";

            resultContent.innerHTML = `
                <div class="mb-4">
                    <h4>Final Credit Score: ${score}/100</h4>
                    <div class="progress mb-3">
                        <div class="progress-bar ${approved ? 'bg-success' : 'bg-danger'}" style="width: ${Math.max(0, Math.min(100, score))}%"></div>
                    </div>
                    <p>${statusMessage}</p>
                </div>
                
                <div class="score-breakdown">
                    <h5>📊 Detailed Scoring Breakdown:</h5>
                    ${factors.map(factor => `<div>• ${factor}</div>`).join('')}
                </div>
                
                ${!approved ? `
                <div class="mt-4 p-3 bg-light rounded">
                    <h5>💡 Improvement Suggestions:</h5>
                    <ul>
                        <li>Focus on clearing any default history and maintaining clean credit</li>
                        <li>Increase your income or reduce the loan amount requested</li>
                        <li>Maintain stable employment for at least 2+ years</li>
                        <li>Consider a co-signer if available</li>
                        <li>Wait 6-12 months before reapplying after improvements</li>
                    </ul>
                </div>
                ` : `
                <div class="mt-4 p-3 bg-light rounded">
                    <h5>🎯 Next Steps:</h5>
                    <ul>
                        <li>You will receive loan documents via email within 24 hours</li>
                        <li>Review and sign the loan agreement</li>
                        <li>Funds will be disbursed within 3-5 business days</li>
                        <li>Set up automatic payments to maintain good standing</li>
                    </ul>
                </div>
                `}
            `;

            resultSection.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>